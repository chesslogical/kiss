<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>otp2 – One-Time-Pad XOR Transformer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --bg: #f8f9fa;
            --fg: #212529;
            --code-bg: #e9ecef;
            --accent: #0d6efd;
            --border: #dee2e6;
        }
        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #212529;
                --fg: #f8f9fa;
                --code-bg: #343a40;
                --accent: #4dabf7;
                --border: #495057;
            }
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg);
            color: var(--fg);
            line-height: 1.6;
            margin: 0;
            padding: 2rem;
        }
        .container {
            max-width: 900px;
            margin: auto;
            background: var(--bg);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,.1);
        }
        h1, h2, h3 {
            color: var(--accent);
            border-bottom: 1px solid var(--border);
            padding-bottom: .3em;
        }
        pre, code {
            background: var(--code-bg);
            border-radius: 4px;
            font-family: "Fira Code", Menlo, Consolas, monospace;
            overflow-x: auto;
        }
        pre {
            padding: 1rem;
            margin: 1rem 0;
        }
        code {
            padding: .2em .4em;
        }
        .highlight { background: #fff3cd; padding: .1em .3em; border-radius: 3px; }
        .note {
            background: #d1ecf1;
            border-left: 4px solid #0d6efd;
            padding: .8rem;
            margin: 1rem 0;
            font-style: italic;
        }
        .footer {
            text-align: center;
            margin-top: 3rem;
            font-size: .9rem;
            color: #6c757d;
        }
        a { color: var(--accent); text-decoration: none; }
        a:hover { text-decoration: underline; }
    </style>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
          rel="stylesheet" integrity="sha512-..." crossorigin="anonymous">
</head>
<body>
<div class="container">

<h1><i class="fas fa-lock"></i> otp2 – One-Time-Pad Style XOR Transformer</h1>

<p><strong>Version:</strong> 3.1.0 | <strong>Platform:</strong> Linux only (Fedora 43+)</p>

<hr>

<h2>Overview</h2>

<p><code>otp2</code> is a tiny, secure, in-place XOR utility that behaves like a <em>one-time pad</em> when used correctly.</p>

<ul>
    <li><strong>Always in-place</strong> – no extra copies left behind.</li>
    <li><strong>Atomic replace</strong> via <code>rename(2)</code> (safe on the same filesystem).</li>
    <li><strong>Key wrapping</strong> – if the key is shorter, it repeats (still useful for obfuscation).</li>
    <li><strong>Zeroize</strong> sensitive buffers.</li>
    <li><strong>File locking + TOCTOU checks</strong> to prevent races.</li>
    <li><strong>No Windows code</strong> – stripped for size and clarity.</li>
</ul>

<div class="note">
    <strong>Security note:</strong> Real OTP requires a key that is <em>truly random, at least as long as the plaintext, used only once, and kept secret</em>. Shorter/wrapped keys give only obfuscation, not cryptographic security.
</div>

<h2>Installation</h2>

<pre><code># 1. Clone & enter
git clone https://github.com/yourname/otp2.git
cd otp2

# 2. Install build tools (Fedora 43+)
sudo dnf5 group install development-tools

# 3. Build release binary
cargo build --release

# 4. (Optional) Install system-wide
sudo cp target/release/otp2 /usr/local/bin/
</code></pre>

<h2>Usage</h2>

<p>All files <strong>must be in the same directory as the <code>otp2</code> binary</strong>:</p>

<pre><code># Create a test file
echo "Hello, OTP!" > message.txt

# Generate a random key (64 bytes example)
head -c 64 /dev/urandom > key.key

# Encrypt / Decrypt (same command toggles)
./otp2 message.txt
</code></pre>

<p>Running the command <strong>twice</strong> returns the original plaintext.</p>

<h3>Command line</h3>

<pre><code>otp2 &lt;INPUT&gt;

  &lt;INPUT&gt;   File to transform (relative or absolute path).
            If relative, resolved against the executable directory.
</code></pre>

<h2>Rules (Enforced)</h2>

<table>
    <tr><th>Rule</th><th>Why</th></tr>
    <tr><td><code>key.key</code> next to binary</td><td>Prevents accidental key reuse across dirs</td></tr>
    <tr><td>Input file in same directory</td><td>Guarantees atomic rename works</td></tr>
    <tr><td>Refuse to touch <code>key.key</code> or the binary itself</td><td>Safety</td></tr>
    <tr><td>Only regular files</td><td>Avoids special files, devices, symlinks</td></tr>
    <tr><td>Exclusive file locks</td><td>Prevents concurrent runs</td></tr>
    <tr><td>TOCTOU identity checks</td><td>Defends against file replacement races</td></tr>
</table>

<h2>Build Options</h2>

<ul>
    <li><code>cargo build --release</code> → optimized, stripped binary.</li>
    <li><code>strip target/release/otp2</code> → minimal size (~200 KB).</li>
</ul>

<h2>License</h2>

<p>MIT OR Apache-2.0 – see <code>Cargo.toml</code>.</p>

<h2>Contributing</h2>

<p>Patches welcome! Keep it <strong>Linux-only</strong> and <strong>zero-unsafe</strong>.</p>

<div class="footer">
    <p>© 2025 Your Name – <a href="https://github.com/yourname/otp2">github.com/yourname/otp2</a></p>
</div>

</div>
</body>
</html>
