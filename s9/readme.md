s9 is a command-line interface (CLI) tool developed in Rust for encrypting and decrypting files using the Threefish-1024 block cipher in CTR (Counter) mode, combined with HMAC-SHA512 for integrity and authenticity checks. Designed for simplicity, it requires only the filename as input (e.g., ./threefish_encrypt myfile.txt) and operates on files in the same directory as the executable, automatically determining whether to encrypt or decrypt based on a magic header ("TF1024ENC" as 9 bytes) at the file's beginning—if present, it decrypts; otherwise, it encrypts. During encryption, the tool generates a random 16-byte initialization vector (IV), encrypts the content, computes a 64-byte HMAC tag over the header, IV, and ciphertext, and formats the output as header + IV + ciphertext + tag. For decryption, it extracts the IV and tag, verifies the HMAC (failing on tampering or incorrect key), and decrypts to plaintext. Operations are in-place with atomic overwrites via a temporary file to avoid data corruption, and the encryption key is hard-coded as a 128-byte array in the source code (editable at compile time for versatility, but users should replace the default demonstration key with a securely generated random one, such as via openssl rand 128, and recompile). The tool leverages dependencies including threefish (0.5), cipher (0.4), clap (4.5 with derive), anyhow (1.0), rand (0.8), hmac (0.12), and sha2 (0.10) for cryptographic operations, argument parsing, error management, and randomness. While suitable for secure file handling with its robust cipher and authentication, it processes files entirely in memory (limiting use with very large files), lacks password derivation, and emphasizes that hard-coding keys reduces portability and increases security risks if the binary is shared—ideal for personal or embedded use cases where recompilation is feasible.
