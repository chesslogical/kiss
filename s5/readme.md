SPS is a simple command-line tool written in Rust for encrypting and decrypting files using the XChaCha20-Poly1305 authenticated encryption algorithm. It derives encryption keys from user-provided passwords via Argon2id, ensuring secure key generation without the need for separate key files. The tool operates on files in the current working directory only, restricting paths, hidden files, and parent directory access for enhanced security. It automatically detects whether to encrypt or decrypt based on a magic header in the file, but this can be overridden with force flags.
To build and install SPS, ensure you have Rust and Cargo installed. Clone the repository or copy the source files, then navigate to the project directory and run 'cargo build --release'. The binary will be available in 'target/release/sps'. You can add it to your PATH for easy access. The tool depends on several crates including anyhow for error handling, clap for command-line parsing, chacha20poly1305 for encryption, rand for randomness, fs2 for file locking, log and env_logger for logging, hex for temporary file naming, zeroize for secure memory zeroing, argon2 for key derivation, and rpassword for secure password input.

Usage is straightforward: run 'sps <filename>' to process a file, where it will prompt for a password. For encryption, it generates a random salt and nonce base, derives the key, and encrypts the file in 8 MiB chunks, overwriting the original atomically via a temporary file. For decryption, it reads the header to extract the salt and nonce, derives the key from the password, and decrypts chunk by chunk, verifying integrity with Poly1305 tags. Use '--force encrypt' or '--force decrypt' to override auto-detection, and '--verbose' for detailed logging. The tool handles empty files with a warning and errors out on invalid inputs like non-existent files or corrupted data.

Key features include chunked processing for large files, per-chunk authentication to detect tampering, exclusive file locking to prevent concurrent modifications, and zeroizing of sensitive data in memory. The header format consists of an 8-byte magic string ('SPSv2\0\0\0'), 16-byte salt, 16-byte nonce base, and 8-byte original file length. Security relies on strong passwords; weak ones may be vulnerable to brute-force attacks. Always use unique, complex passwords. The tool is licensed under MIT or Apache-2.0 and is intended for personal use on Linux systems, with atomic overwrites optimized for reliability there.

For contributions or issues, refer to the source code. This tool does not support key files, multiple files, or compression, focusing on simplicity and security for single-file operations. Test it on non-critical data first to ensure compatibility.
