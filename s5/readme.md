SPS (Simple Password Secure) is a command-line tool written in Rust for encrypting and decrypting files in place using a password-derived key with strong cryptographic primitives. It leverages XChaCha20-Poly1305 for authenticated encryption, ensuring confidentiality and integrity, and Argon2id for key derivation to resist brute-force attacks. The tool automatically detects whether a file needs encryption or decryption based on a magic header in encrypted files, but users can force a mode if needed. Files are processed in 8 MiB chunks to handle large sizes efficiently without loading everything into memory, and operations use atomic file replacement via temporary files to prevent data loss from interruptions. Security features include random salts and nonces per file, unique chunk nonces to avoid reuse, additional authenticated data (AAD) binding chunks to the header and indices to thwart reordering attacks, exclusive file locks to avoid concurrent modifications, and zeroing of sensitive memory like keys and passwords. SPS restricts operations to the current directory, disallowing paths, hidden files, or traversal attempts for safety. Dependencies include anyhow for error handling, clap for CLI parsing, chacha20poly1305 for encryption, rand and OsRng for randomness, fs2 for file locking, log and env_logger for logging, hex for temp file naming, zeroize for secure memory wiping, argon2 for key derivation, and rpassword for secure password input. To build and install, ensure Rust (edition 2021) is installed, then run 'cargo build --release' to compile, and optionally copy the binary to a PATH directory. Usage involves running 'sps <filename>' which prompts for a password; it encrypts if the file lacks the header or decrypts otherwise. Options include --output <file> for non-in-place output, --force encrypt|decrypt to override auto-detection, --verbose for detailed logging, --iterations <n> (default 2), --memory <MiB> (default 19), --parallelism <n> (default 1) to tune Argon2 parameters for stronger security at the cost of performance, and --confirm-password false to skip confirmation during encryption. For decryption, a wrong password or corrupted file will fail with an error. The tool handles empty files gracefully and includes tests for key derivation, round-trip encryption/decryption, wrong passwords, and empty files. SPS is licensed under MIT or Apache-2.0 and is suitable for local file protection, but users should employ strong, unique passwords and note that it does not handle key sharing or multi-user scenarios.
